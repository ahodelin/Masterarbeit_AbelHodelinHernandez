\section{Harmonisierung der Maßeinheiten} \label{sec:unitscopra}

Nach der Validierung des Ergebnisses des Pattern Matchings und mit den eingefügten Maßeinheiten in die Tabelle der resultierenden Zuordnung, folgte eine detaillierte Untersuchung der Maßeinheiten in \ac{copra} und einen Vergleich zwischen den Maßeinheiten beider Systeme für die Harmonisierung der Einheiten beider Systeme.

Die zwei Paare von zugeordneten Profilen mit Konfigurationsvariablen bei denen die Konfigurationsvariablen keine Maßeinheiten weder in der Tabelle \texttt{co6\_config\_variables} noch im Frontend von \ac{copra} erhalten haben (\ref{tab:nounitscopra}), werden in diesem Projekt nicht weiter betrachtet, weil solche Werte mit unbekannten Maßeinheiten in \ac{copra} sich nicht harmonisieren lassen.

\begin{table}[ht]
	\centering
	\caption[Konfigurationsvariablen ohne Maßeinheiten]{Konfigurationsvariablen ohne Maßeinheiten.}
	\label{tab:nounitscopra}
	\begin{tabular}{|p{3cm}|p{3cm}|l|l|} \hline
		\bfseries Profilname & \bfseries \ac{copra}-Name & \bfseries Profil-Einheit &  \bfseries \ac{copra}-Einheit \\ \hline
		Ionisiertes Kalzium aus Nierenersatzverfahren & NEV\_CRRT\_VO\_ CalciumLoesung & mmol/L & \textcolor{magenta}{NULL} \\ \hline
		Zeitverhaeltnis-Ein-Ausatmung & Beatmung\_ MS\_G5\_IE Verhaeltnis & \{ratio\}  & \textcolor{magenta}{NULL} \\ \hline		
	\end{tabular}
\end{table}

 Nach der Untersuchung der Maßeinheiten in \ac{copra} wurden 38 unterschiedliche Konfigurationsvariablen mit derselben Maßeinheit wie bei den zugewiesenen \ac{fhir}-Profilen, aber mit unterschiedlichen Schreibweisen, erkannt. Die \ref{tab:unitscopra} zeigt einige Beispiele davon.

\begin{table}[ht]
	\centering
	\caption[Schreibweisen derselben Maßeinheiten in beiden Systemen]{Schreibweise derselben Maßeinheiten in beiden Systemen.}
	\label{tab:unitscomii}
	\begin{tabular}{|l|l|l|} \hline
		\bfseries Profil-Einheit & \bfseries \ac{copra}-Einheit & \bfseries Anmerkung \\ \hline
		cm[H2O] & cmH2O & - \\ \hline
		Cel & C° & - \\ \hline
		\{Breaths\}/min & AZ/min & Atemzüge pro Minute \\ \hline
	\end{tabular}
\end{table}

Auch dieselbe Maßeinheit wurde zwischen Konfigurationsvariablen unterschiedlich dargestellt. Dieses Phänomen wurde in sieben Fälle gefunden. Die \ref{tab:unitscopra} zeigt einige Beispiele dieses Ereignisses.

\clearpage

\begin{table}[ht]
	\centering
	\caption[Beispiel der Schreibweise derselbe Maßeinheit in \acs{copra}]{Beispiel der Schreibweise derselbe Maßeinheit bei unterschiedlichen Konfigurationsvariablen in \acs{copra}. bpm steht für \glqq breaths per minute\grqq{}.}
	\label{tab:unitscopra}
	\begin{tabular}{|p{3cm}|p{3cm}|l|l|} \hline
		\bfseries Profilname & \bfseries \ac{copra}-Name & \bfseries Profil-Einheit &  \bfseries \ac{copra}-Einheit \\ \hline
		Mittlerer Beatmungsdruck & Beatmung\_ MS\_VisionA \_MAP & cm[H2O] & cm H2O \\ \hline
		Mittlerer Beatmungsdruck & Beatmung\_ MS\_Servoi \_Pmean & cm[H2O] & [cmH2O] \\ \hline \hline
		Mechanische-Atemfrequenz-Beatmet & Beatmung\_ MS\_Evita4 \_frequenz & \{Breaths\}/min & bpm \\ \hline
		Mechanische-Atemfrequenz-Beatmet & Beatmung\_ MS\_G5\_ftotal & \{Breaths\}/min & AZ/min \\ \hline
	\end{tabular}
\end{table}

In der Untersuchung der Maßeinheiten wurde auch eine fehlerhafte Darstellung der Maßeinheit bei einer Konfigurationsvariable festgestellt. Diese Problematik konnte auch nicht von den Experten der \ac{pdms}-Abteilung geklärt werden. Aus diesem Grund wird diese Konfigurationsvariable nicht weiter betrachtet. Die \ref{tab:errounit} zeigt die Konfigurationsvariable mit diesem Problem.

%\clearpage

\begin{table}[ht]
	\centering
	\caption[Fehlerhafte Darstellung Maßeinheiten in \acs{copra}]{Fehlerhafte Darstellung Maßeinheiten in \acs{copra}.}
	\label{tab:errounit}
	\begin{tabular}{|p{3cm}|p{3cm}|l|l|} \hline
		\bfseries Profilname & \bfseries \ac{copra}-Name & \bfseries Profil-Einheit & \bfseries \ac{copra}-Einheit \\ \hline
		Linksventriku- laerer Schlagvolumenindex & Vigileo\_SVI & mL/m2 & ml/b/m$^2$ml/b/m$^2$ \\ \hline
	\end{tabular}
\end{table}

Es wurden acht Konfigurationsvariablen mit Maßeinheiten identifiziert, die nicht dieselben Maßeinheiten haben wie die Einheiten der \ac{fhir}-Profile. Die Maßeinheiten von sieben dieser Konfigurationsvariablen konnten in die Maßeinheiten der \ac{fhir}-Profile umgerechnet werden. Diese Umwandlung wird durch die Multiplikation der numerischen Werte der Werttabellen mit Umrechnungsfaktoren realisiert. Die \ref{tab:unittoconvert} zeigt die Liste der betroffenen Maßeinheiten.  

\clearpage

\begin{table}[ht]
	\centering
	\caption[Maßeinheiten und Umrechnungsfaktoren für die Harmonisierung]{Maßeinheiten und Umrechnungsfaktoren für die Harmonisierung. Die 1 in den Einheiten der \ac{fhir}-Profile bedeutet \glqq decimal fraction\grqq{} \cite{unitsloinc}. Die Werte der Konfigurationsvariablen mit den gleichen Maßeinheiten wie die \ac{fhir}-Profile werden mit 1 multipliziert.}
	\label{tab:unittoconvert}
	\begin{tabular}{|l|l|l|} \hline
		\bfseries \ac{copra}-Einheit & \bfseries Profil-Einheit & \bfseries Faktor/Konversion \\ \hline
		mbar & cm[H2O] & 1.01972 \\ \hline
		\% & 1 & 0.01 \\ \hline
		mmHg & cm[H2O] & 1.35951 \\ \hline
		min & h & 0.016667 \\ \hline
		\multicolumn{2}{|l|}{\ac{copra}-Einheit = Profil-Einheit} & 1 \\ \hline
	\end{tabular}
\end{table}

Andere Maßeinheiten von Konfigurationsvariablen können nicht in die Einheiten der \ac{fhir}-Profile umgewandelt werden, denn die Dimensionen der physikalischen Größen beider Maßeinheiten sind in beiden Systemen nicht dieselben. Diese Konfigurationsvariablen werden in diesem Projekt nicht weiter betrachtet. Die \ref{tab:unitnocompat} zeigt die betroffenen Maßeinheiten. 

\begin{table}[ht]
	\centering
	\caption[Nicht kompatible Maßeinheiten]{Nicht kompatible Maßeinheiten.}
	\label{tab:unitnocompat}
	\begin{tabular}{|p{3.3cm}|p{1.7cm}|p{2.6cm}|p{2cm}|p{1.8cm}|} \hline
		\bfseries Profilname & \bfseries \ac{copra}-Name & \bfseries \ac{copra}-Description & \bfseries Profil-Einheit & \bfseries \ac{copra}-Einheit \\ \hline
		Linksventrikulaerer Herzindex & dPmax & Index der linken Ventrikelkontraktilität & L/(min.m2) & mmHg/s \\ \hline
	\end{tabular}
\end{table}

Die Inkompatibilität dieser Einheiten liegt daran, dass die Dimensionen von L/(min.m2) Volumen, Zeit und Flächeninhalt sind. Die Dimensionen von mmHg/s wiederum sind Druck und Zeit. Diese Maßeinheit wird für das Ablassen der Manschette bei der Blutdruckmessung benutzt. In \ac{copra} hingegen wird diese Maßeinheit an einer Konfigurationsvariable für die Messung des Indexes der linken Ventrikelkontraktilität gesetzt.

Am Ende dieser Analyse bleiben 76 Einträge im Datensatz der zugeordneten Paare der Konfigurationsvariablen mit den \ac{fhir}-Profilen mit insgesamt 71 Konfigurationsvariablen und 39 \ac{fhir}-Profilen. Der resultierende Datensatz wurde in die Tabelle \texttt{mapping\_mii\_co6\_2} importiert. Diese neue Tabelle hat wiederum dieselbe Struktur wie \texttt{mapping\_mii\_co6} (\ref{tab:mapping}) mit einer neuen Spalte \texttt{unit\_transform} des Datentyps \glqq numeric\grqq{} mit dem Faktor für die Umrechnung der gespeicherten Biosignalen in den Maßeinheiten der \ac{fhir}-Profilen. Somit sind die Einheiten beider Systeme harmonisiert.